<div align="center">

  # Decoding Quantum States through <br> Nuclear Magnetic Resonance

  <a href="https://summerofcode.withgoogle.com/projects/#6588988095201280" target="_blank"><img src="https://img.shields.io/badge/Google%20Summer%20of%20Code-2021-fbbc05?style=flat&logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAALVBMVEVHcEz7vQD7vQD8vQD7vQD8vQD7vQD8vQD8vQD7vQD7vQD8vQD7vQD7vQD7vQAgxtLpAAAADnRSTlMAZvVQ6QrVPhl6oSmHvzL6LQUAAASGSURBVHjatdnZdusgDAVQELMY%2Fv9zb2%2Bwc%2BIKDzQLvTXB3gYBFqmaDVeKU4sCBlFyy43WqLjlBpR1BpR1BpR1xjoFxmIFBpSVBpSVBpSVBpSVBpQ1xvdK1oPgblhfOWltjNaJq7ddYT2IfImYJqMDrENUChGDZn%2FWQ%2FMHxBcD4BMyBc5XCHkNQTq60vfIgXAx5xByju6T8V8itsT3%2FUPi6r39Ce8rp%2FCWYrHfIDXs95FZJs%2FvTob6Z4T2buQE4eikvHeG%2FoZY7TpRfDsNWzrjtP0L4s12NYhh%2BO1ZjJ9HfOjdYGo3QZx7YvwEAgOPdx3eQJlArMFA3wXSZ%2BwMQvplJGoPY6sqNU0gxcGYUVx5jtSIx3oS6HysTxEbMMDPAmkM9iFSXnPXt8nwuQ%2FYI8TH%2F425TQe7%2FnBPEH2bECI6T4t%2Bgvh4N1istR50FJdeIX1Ek%2FqJdGGQOWmAa4u7rn18vuuIzUq52gbxvpiSuzIau%2BuO9FUUfTvvCjcoQ4MMltRnEOqF0pdD%2FwiBZWxoqGCn8r2VGKIUCHOoTyHK2g7y1bsJRRqNe3%2FlXv5GbNhWEWXxbsf1UITRF4kYcM4KiI%2FbeFIevNNq7P2EIg0bVL%2BfqCcyYV2rbDdExWSPjUPPGBRh9JTowTscW0Dqf%2BwLXGmPthgKKMJo1f1OSQ29hf1Mbdlmg5NFV1H7KoICA3mruIQ4vl4TTFhvuAlxxrdb1J55KMJoBatEPCv6mr3sJzK%2F9RQKDAx49Ji5ctSLwsxAxgyuiduOAeVtIG14zppPKtAka9lcMZz71IHyNoAcCpvIx6UfxGLleCim3ggUpe0dQhe7I86mWvQERZmCIocryAqPsdYOSQlVIjCgyMRbLSaXxi3GD4LEw4AipzCyyvS5a5ThMpJTGAYUuQljhiWL53R11FN5BxhQsK0UWbE747E7evGV2FaEAUWmDave0H4LQxg6nErl1IEBBRdmOzjkBPpdqFB%2BpUtUGb0tDKloZP44hQLthQoDwXYiXlowpMJIymExdARL8SViYzymhGEMFR%2FR3cOyNoRCpQcZFu1s6AsNhlQuSiJP%2B1Kk90dNRHW9BYyhwlszhNgdb05CjmGcKDb3DotAoYIYV9wWxjDSZcHNmN%2Fj0KpPm3R7dMjq7HlrSokvjIqjww3SEhb4XJDpg3CLvM9%2BPG%2FMHOcaOwzYRFScNe8QHJb9nOEDhvkGwV48eZC3BgfzWwSHZaXthKEVMvkMaQnKhKESzSCkJ37uQqlJ7RmCIcbr%2By5qUEjiIwQK3q4yZKHqYDxEUIo4U6%2BNahxKr0kEZwv8HC%2BDqo69UaI2ieBAujN2RNhOoPybQjBr9oNSKNXSoQ%2B2luCUQuk1iSCIg9oiZl24Vv8TtXLROaotAtO3%2F9ooWSFcjDnH6BQio2SZQSRz%2FpsPfsifQ2RY1tmNBM3oxQRCbRjkOZn%2FEACT2J%2B1vkZiGESyG1SZS%2FqJ1wTogE1hEFHNh9yNCbvvREwqCwwoawwoKw0oKw0oKw0oKw0oKw0oKw0oMFYqMFYqMFYqMBYq88Y%2FxB7wiOJRvWkAAAAASUVORK5CYII%3D" /></a>
  

[![Contributors][contributors-shield]][contributors-url]
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![LinkedIn][linkedin-shield]][linkedin-url]
[![Twitter][twitter-shield]][twitter-url]

 A research project that uses Machine Learning techniques to study and understand the electronic properties of low-temperature materials via simulations of Nuclear Magnetic Resonance. 
  
  <a href="https://ml4sci.org/" target="_blank"><img alt="gsoc@ml4sci" height="200px" src="https://github.com/Anantha-Rao12/Decoding-Quantum-States-with-NMR/blob/main/Assests/gsoc-ml4sci.jpg" /></a>

</div>

## Table of Contents

* [About the Project](#about-the-project)
* [Installation](#installation)
* [Dataset](#dataset)
* [Contributing](#contributing)
* [License](#license)
* [Contact](#contact)
* [Future Work](#future-work)
* [Mentors](#mentors)

## About the Project

At low temperatures, many materials transition into an electronic phase which cannot be classified as a simple metal or insulator. Novel quantum phases of matter like superconductors and spin liquids are harder to study due to their fragile nature, making non-intrusive and indirect measurements important. Scientists hence use Nuclear Magnetic resonance (NMR) to probe these materials externally. NMR is an experimental technique mainly used in quality control and scientific research to determine the molecular structure, purity, and content of any sample. The GSoC project idea is to explore the connection between electronic phases and nuclei in these materials via simulations of NMR. We analyze the time-evolution of nuclear spins due to external magnetic pulses, and classify them using suitable Machine Learning models. We also aim to optimize an applied magnetic pulse sequence to best estimate a specific physical parameter from a given material.


## Installation

1. Clone this Github repository using the following command in your command line/terminal : <br>
```git clone https://github.com/Anantha-Rao12/Decoding-Quantum-States-with-NMR.git```

2. Create a Python (>=3.2) virtual environemnt and call it 'Decoding-Quantum-States-with-NMR-env'.
  - On Linux/ MacOS : ```python3 -m venv Decoding-Quantum-States-with-NMR-env```
  - On Windows : ```python -m venv Decoding-Quantum-States-with-NMR-env```

A new directory called `Decoding-Quantum-States-with-NMR-env` will be created. 

3. Activate the Virtual Environment by running:
  - On Linux/ MacOS: ```source Decoding-Quantum-States-with-NMR-env/bin/activate```
  - On Windows: ```.\Decoding-Quantum-States-with-NMR-env\Scripts\activate```

4. In the new virtual environemnt , run ```pip3 install -r requirements.txt``` to install all dependencies. On Windows, `pip3` should be replaced by `pip`.

You are ready to start experiemnting with the code!

## Dataset

In atomic and condensed matter physics, scientists use nuclear magnetic resonance (NMR) as a non-intrusive method to understand the atomic composition and electronic structure of materials. This summer, we have worked to extend NMR to the sensing of strong electronic spin-spin correlations and non-dissipative spin-spin interactions between nuclei. To study a wide range of physical phenomenon, we simulate the behaviour of a typical [NMR spin echo experiment](https://en.wikipedia.org/wiki/Spin_echo) on a lattice of 2D spins with different kinds of inter-nuclei interactions and coupling-strengths. We employ a Gaussian, RKKY and a Power-Law type kernel for inter-nuclei interactions to mimic long-range (from gapped spin excitations) and short-range (from gapless spin excitations) interactions. Since the average magnetization measured during the spin echo is a function of the local interaction types and the electronic susceptibility of the underlying material, we aim to understand the material type and predict the coupling strengths from machine learning classification and regression models based solely on the shape of the echo curve. The dataset we use is the magnitude of average nuclear magnetization as a function of time, as measured during multiple spin-echo simulations. 

<div align="center">
<img src="https://github.com/Anantha-Rao12/Decoding-Quantum-States-with-NMR/blob/main/Assests/dataset_1.png"  alt="NMR simulation Dataset" width="800" height="400">
</div>

## Contributing

The main point of open source projects is to create valuable and accessible open source software to be used by all and build by all. I would love to receive suggestions and contributions. To contribute you can: 
 
1. Fork this repository
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

If you find issues with anything, please open an issues under the `Issues` tab. 

## License

Distributed under the MIT License. See `LICENSE` for more information.

## Contact

DM Anantha S Rao - [@anantharao00](https://twitter.com/anantharao00) <br>
For clarifications and queries -- [Anantha Rao](mailto:aanantha.s.rao@gmail.com?subject=[GSoC2021_NMR]) @2021

Project Link: [https://github.com/AnanthaRao-12/Decoding-Quantum-States-with-NMR](https://github.com/Anantha-Rao12/Decoding-Quantum-States-with-NMR)


## Results

We build both classification models to classify the magnetization time-series into the three interaction types and regression models to predict interaction parameters (αx, αz, ξ) or the total kernel integral over the entire set of spins (ΣK(r(i,j)). We used ensemble learning and combined many weak decision tree learners to build a random-forest classifier/regressor. Furthermore, we extracted the essential features from the time-series and frequency domain data to understand the sub-sections during the echo-pulse that are most useful for understanding the material. More details about feature extraction methods and ML techniques are available in the `/Tutorial-nbs` section. 

- Using machine learning, we were able to classify long-range interaction types (power law kernel) and short-range interaction types (gaussian and RKKY kernel type) with an F1 score of ~0.88
- With knowledge of the type of interaction, we were able to predict the value of the kernel integral with an R^2 of ~0.8


## Future Work

- Based on the above promising results, we would like to further explore if deep learning can offer better performance on classification/regression without compromising the model’s interpretability. Although this would entail the need for larger datasets and computing power, the new insights garnered will be very useful in discerning new physics and further contribute to harnessing the data revolution to build and explore novel quantum materials. 
- We would also like to explore optimizing and tuning of the applied magnetic pulses in silico to design an experiment that can predict the coupling-strengths with higher accuracy. 



I hope this project and auxillary scripts benefit someone who is trying to solve a similar problem. Although not the perfect solution, I hope these scripts can give you an idea of how to approach the problem. If you found something helpful, do consider starring the repository, creating an issue or just drop a message! 


## Mentors

### Mentor Organization
[Machine Learning for Science (ML4SCI)](https://ml4sci.org/)

[Dr. Stephen Carr](https://sites.google.com/view/stcarr), [Prof Vesna Mitrovic](https://brown.edu/Research/condensed-matter-nmr/), [Prof Chandrasekhar Ramanathan](https://sites.dartmouth.edu/quantum-spin-lab/), [Prof Brad Marston](https://sites.brown.edu/bradmarston/)

A special token of gratitude to Dr Stephen Carr for his invaluable feedback, suggestions and advice on every aspect of the project and guiding me through the very process of scientific research. 

### Project Proposal

- [Project idea from Organization](https://ml4sci.org/gsoc/2021/proposal_NMR.html)
- [Student Proposal](https://github.com/Anantha-Rao12/Decoding-Quantum-States-with-NMR/blob/main/Assests/GSoC21-ML4SCI_NMR_Proposal-AnanthaRao.pdf)


Have a good day! 

<!-- MARKDOWN LINKS & IMAGES -->

[contributors-shield]: https://img.shields.io/github/contributors/Anantha-Rao12/Decoding-Quantum-States-with-NMR.svg?style=flat-square
[contributors-url]: https://github.com/Anantha-Rao12/Decoding-Quantum-States-with-NMR/graphs/contributors
[linkedin-shield]: https://img.shields.io/badge/-LinkedIn-black.svg?style=flat-square&logo=linkedin&colorB=555
[linkedin-url]: https://www.linkedin.com/in/anantha-s-rao/
[twitter-shield]: https://img.shields.io/twitter/follow/anantharao00?color=%23000011&label=Follow
[twitter-url]: https://twitter.com/anantharao00/
